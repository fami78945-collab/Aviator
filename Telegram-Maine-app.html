<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>My app</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
    
        :root {
            /* --- Modern & Professional Color Palette (Violet & Teal) --- */
            --primary-color: #7C3AED;
            --primary-dark: #6D28D9;
            --secondary-color: #14B8A6;
           --accent-color: #F59E0B;

            --border-color-1: #7C3AED;

            --bg-light: #F9FAFB;      
            --bg-dark: #111827;       
            --card-bg-light: #FFFFFF;
            --card-bg-dark: #1F2937;   
            --text-dark: #1F2937;     
            --text-light: #E5E7EB;     
            --border-color-light: #E5E7EB; 
            --border-color-dark: #374151; 

            /* Sizes */
            --border-radius: 16px;
            --border-radius-sm: 10px;
           --transitio: all 0.3s ease-in-out;
        }

        /* Light Mode Variables */
        body:not(.dark-mode) {
            --app-bg: rgba(249, 250, 251, 0.97);
            --header-bg: linear-gradient(135deg, #4F46E5, #A855F7);
            --header-text-color: #FFFFFF;
            --card-bg: var(--card-bg-light);
            --nav-bg: var(--card-bg-light); /* ADDED: Opaque nav background */
            --text-primary: var(--text-dark);
            --text-secondary: #6B7280;
            --border-color: var(--border-color-light);
            --input-bg: #F3F4F6;
            --input-border: #D1D5DB;
        }

        /* Dark Mode Variables */
        body.dark-mode {
            --app-bg: rgba(17, 24, 39, 0.97);
            --header-bg: linear-gradient(135deg, #4c1d95, #2e1065);
            --header-text-color: var(--text-light);
            --card-bg: var(--card-bg-dark);
            --nav-bg: var(--card-bg-dark); /* ADDED: Opaque nav background */
            --text-primary: var(--text-light);
            --text-secondary: #9CA3AF; 
            --border-color: var(--border-color-dark);
            --input-bg: #374151;
            --input-border: #4B5563;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            background-image: url('459747a6dc06d8c61209f94b4bf02e9d.jpg'); 
            background-size: cover;
            background-position: center top;
            background-attachment: fixed; 
            background-color: var(--bg-light);
        }
        body.dark-mode {
            background-color: var(--bg-dark);
        }
        
        .app-container {
            max-width: 400px;
            margin: 0 auto;
            position: relative;
            background-color: var(--app-bg);
            min-height: 100vh; /* Ensures container takes full height */
            box-shadow: 0 0 25px rgba(0, 0, 0, 0.15);
            display: flex; /* Enables flexbox layout */
            flex-direction: column; /* Stacks children vertically */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        .header {
            height: 120px; 
            background: var(--header-bg);
            color: var(--header-text-color);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom-left-radius: var(--border-radius);
            border-bottom-right-radius: var(--border-radius);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            flex-shrink: 0;
        }
        
        .logo-container {
            position: absolute;
            top: 5px;
            left: 15px;
            width: 60px; 
            height: 60px;
        }
        .logo-container img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .theme-toggle {
            position: absolute;
            top: 15px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #FFFFFF;
            cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        body.dark-mode .theme-toggle {
            background: #374151;
            color: var(--text-primary);
            border-color: var(--border-color);
        }
        
        .profile-section {
            margin-top: -50px;
            padding: 0 15px;
            position: relative;
            z-index: 2;
            flex-shrink: 0;
        }
        
        .profile-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 110px 20px 20px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden; 
        }
        
        .profile-banner {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100px; 
            background-color: var(--primary-color); 
            background-size: cover;
            background-position: center;
            border-top-left-radius: var(--border-radius);
            border-top-right-radius: var(--border-radius);
            overflow: hidden;
        }

        .edit-banner-btn {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.4);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            transition: var(--transitio);
        }
        .edit-banner-btn:hover {
            background: rgba(0, 0, 0, 0.6);
        }
        
        .profile-pic-container { 
            position: absolute;
            top: 45px;
            left: 50%;
            transform: translateX(-50%);
            width: 90px;
            height: 90px;
            z-index: 5;
            border-radius: 50%;
        }

        .profile-pic {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 2px solid var(--card-bg); 
            object-fit: cover;  
            background: var(--primary-color); 
        }

        .edit-pfp-btn { 
            position: absolute;
            bottom: 0;
            right: 0;
            color: #0E0E18;
            border: 2px solid var(--card-bg);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            font-size: 0.8rem;
            padding: 0;
        }

        .profile-info-header-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px; 
            margin-bottom: 10px;
        }

        .profile-name {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 0; 
            display: flex;
            align-items: center;
            justify-content: flex-end;
            color: var(--text-primary);
            margin-top: 0; 
            flex-grow: 1; 
            margin-right: 15px; 
        }
        
        .points-display {
            display: flex; 
            width: fit-content;
            align-items: center;
            
            padding: 6px 15px;
            border-radius: 50px;
            margin: 0; 
            font-weight: 600;
            color: #A30E38;
            font-size: 0.9rem;
            border: 1px solid rgb(5, 9, 15);
            margin-left: 0; 
        }
        body.dark-mode .points-display {
            border-color: rgba(124, 5, 237, 0.4);
        }

        .points-display i {
            margin-right: 8px;
        }

        .stats-display {
            display: flex;
            justify-content: center; 
            gap: 12px;
            margin-top: 0; 
        }

        .stat-item {
            background: var(--bg-light);
            padding: 10px 25px;
            border-radius: var(--border-radius-sm);
            border: 1px solid var(--border-color);
        }
        body.dark-mode .stat-item {
            background: var(--input-bg);
        }
        
        .content-section {
            flex-grow: 1; /* This makes the content area expand */
            display: flex; /* Make it a flex container as well */
            flex-direction: column; /* Stack its children vertically */
        }

        .task-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.06);
            border: 1px solid var(--border-color);
        }
        
        .task-card-row {
            display: flex;
            gap: 15px; 
            margin-bottom: 20px;
        }

        .task-card-half {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.06);
            border: 1px solid var(--border-color);
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
        }
        .task-card-half .task-header { margin-bottom: 10px; }
        .task-card-half .reward-badge { margin-bottom: 10px; }
        .task-card-half .progress-container { margin-bottom: 10px; }
        .task-card-half .btn { margin-top: auto; }

        .section-title {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        .section-title i { margin-right: 10px; color: var(--primary-color); }
        
        .btn {
            display: block;
            width: 100%;
            padding: 12px;
            border-radius: var(--border-radius-sm);
            border: none;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
        }

        .btn-primary { background: var(--primary-color); color: white; box-shadow: 0 4px 15px rgba(124, 58, 237, 0.3); }
        .btn:disabled { background: var(--border-color) !important; color: var(--text-secondary) !important; cursor: not-allowed; box-shadow: none !important; }
        
        .bottom-nav {
            position: fixed;
            bottom: 0; left: 0; right: 0; height: 55px;
            display: flex; justify-content: space-around; align-items: center;
            padding: 5px 0; box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.07);
            z-index: 100; max-width: 400px; margin: 0 auto;
            background: var(--card-bg);
            border-top: 2px solid var(--border-color-1);
            border-top-left-radius: var(--border-radius);
            border-top-right-radius: var(--border-radius);
        }
        .nav-item { display: flex; flex-direction: column; align-items: center; color: var(--text-secondary); text-decoration: none; font-size: 0.7rem; flex: 1; }
        .nav-item.active { color: var(--primary-color); }
        
        .app-footer {
            text-align: center; padding: 10px 20px 80px 20px;
            color: var(--text-secondary); font-size: 0.9rem;
            margin-top: auto; flex-shrink: 0;
        }
        .app-footer .developer-credit { margin-bottom: 5px; }
        .app-footer .developer-link {
            font-weight: 600; text-decoration: none;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            background-clip: text; text-fill-color: transparent;
        }
        .footer-socials { margin-bottom: 5px; }
        .footer-socials a { color: var(--text-secondary); font-size: 1.5rem; margin: 5px; transition: var(--transitio); }
        .footer-socials a:hover { color: var(--primary-color); }
        .footer-links a { color: var(--text-secondary); text-decoration: none; font-size: 0.9rem; margin: 0 8px; transition: color 0.3s ease; }
        .footer-links a:hover { color: var(--primary-color); text-decoration: underline; }
        .footer-copyright { margin-top:  5px; font-size: 0.70rem; opacity: 0.8; }
        
        .verified-badge { color: var(--secondary-color); margin-left: 5px; font-size: 0.8rem; }
        .stat-value { font-weight: 600; color: var(--text-primary); }
        .stat-label { font-size: 0.7rem; color: var(--text-secondary); }
        .task-header { display: flex; align-items: center; margin-bottom: 15px; }
        .task-icon { width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; margin-right: 10px; color: var(--primary-color); font-size: 1.5rem; }
        .task-title { font-weight: 600; flex: 1; color: var(--text-primary); }
        .reward-badge { background: rgba(245, 158, 11, 0.15); color: var(--accent-color); padding: 4px 10px; border-radius: 50px; font-size: 0.8rem; font-weight: 600; }
        .task-description { color: var(--text-secondary); margin-bottom: 18px; line-height: 1.5; font-size: 0.9rem; }
        .progress-container { margin-bottom: 18px; }
        .progress-text { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.75rem; color: var(--text-secondary); }
        .progress-bar { height: 10px; background: var(--border-color); border-radius: 50px; overflow: hidden; }
        .progress { height: 100%; background: var(--primary-color); border-radius: 50px; transition: width 0.5s ease; }
        .channel-list { list-style: none; }
        .channel-item { display: flex; align-items: center; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid var(--border-color); }
        .channel-info { display: flex; align-items: center; flex: 1; }
        .channel-icon { width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; margin-right: 12px; color: var(--primary-color); font-size: 1.8rem; }
        .channel-name { font-weight: 500; color: var(--text-primary); }
        .channel-reward { font-size: 0.8rem; color: var(--accent-color); }
        .join-btn { padding: 7px 14px; border-radius: var(--border-radius-sm); background: var(--primary-color); color: white; text-decoration: none; }
        .join-btn.claimed { background: var(--secondary-color); cursor: default; }
        .input-group { margin-bottom: 15px; }
        .input-label { display: block; margin-bottom: 6px; font-weight: 500; color: var(--text-secondary); font-size: 0.85rem; }
        .input-field, .select-field { width: 100%; padding: 12px 14px; border-radius: var(--border-radius-sm); border: 1px solid var(--input-border); background: var(--input-bg); color: var(--text-primary); }
        .input-field:focus, .select-field:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.2); }
        
        .input-field.error, .select-field.error { border-color: #EF4444 !important; box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.3) !important; }

        .status-message { text-align: center; margin-top: 15px; padding: 10px; border-radius: var(--border-radius-sm); }
        .success-message { background: rgba(20, 184, 166, 0.1); color: var(--secondary-color); border: 1px solid var(--secondary-color); }
        .error-message { background: rgba(239, 68, 68, 0.1); color: #EF4444; border: 1px solid #EF4444; }
        .ad-modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); display: flex; align-items: center; justify-content: center; z-index: 1000; opacity: 0; pointer-events: none; transition: opacity 0.3s ease; }
        .ad-modal-overlay.show { opacity: 1; pointer-events: all; }
        .ad-modal { background: var(--card-bg); border-radius: var(--border-radius); width: 90%; max-width: 380px; padding: 30px; text-align: center; transform: scale(0.9); transition: transform 0.3s ease; }
        .ad-modal-overlay.show .ad-modal { transform: scale(1); }
        .ad-modal-title { font-size: 1.2rem; margin-bottom: 15px; color: var(--primary-color); font-weight: 600; }
        .spinner { width: 45px; height: 45px; border: 4px solid var(--border-color); border-top-color: var(--primary-color); border-radius: 50%; margin: 20px auto; animation: spin 1s linear infinite; } @keyframes spin { to { transform: rotate(360deg); } }
        .ad-status { margin: 15px 0; color: var(--text-secondary); }
        .toast { position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%); background: #2c3e50; color: white; padding: 12px 22px; border-radius: 30px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.25); z-index: 1001; opacity: 0; transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); }
        .toast.show { opacity: 1; bottom: 95px; }

        #coinCalculation { margin-top: -10px; margin-bottom: 15px; font-size: 0.85rem; color: var(--primary-color); font-weight: 500; }
        .task-card-half .task-title { position: relative; flex: 1; font-weight: 700; white-space: nowrap; }
        
        .level-superscript { font-size: 0.70rem; font-weight: 800; color: #E65100; position: absolute; top: -18px; right: 8px; line-height: 1; padding: 3px 5px; }
        
        .profile-header-settings { margin-top: 0px; position: relative; z-index: 1; }
        .profile-banner-settings { position: absolute; top: 0; left: 0; right: 0; height: 130px; background-color: var(--primary-color); background-size: cover; background-position: center; overflow: hidden; z-index: 2; }
        .profile-summary-settings { height: 230px; padding-top: 150px; position: relative; overflow: hidden; margin-bottom: 10px; }
        .guest-user-pic { width: 80px; height: 80px; border-radius: 50%; margin-bottom: 10px; box-shadow: 0 1px 5px rgba(150,250,0,5.1); position: absolute; top:75px; left: 50%; transform: translateX(-50%); z-index: 5; display: inline-block; }
        .guest-user-pic img { width: 100%; height: 100%; object-fit: cover; border-radius: 50%; }
        .guest-user-pic .edit-pfp-btn { width: 25px; height: 25px; font-size: 0.7rem; bottom: 1px; right: 0; }
        .user-details-settings { text-align: center; padding-top: 10px; }
        .guest-user-name { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .profile-email-settings, .profile-verified-settings { font-size: 0.85rem; color: var(--text-secondary); margin: 3px 0; display: flex; align-items: center; justify-content: center; }
        .profile-email-settings i, .profile-verified-settings i { margin-right: 5px; font-size: 1rem; color: var(--primary-color); }
        .profile-verified-settings i { color: var(--secondary-color) !important; }
        
        .settings-menu-item { display: flex; align-items: center; padding: 12px 0; text-decoration: none; color: var(--text-primary); border-bottom: 1px solid var(--border-color); transition: var(--transitio); }
        .settings-menu-item:last-child { border-bottom: none; }
        .settings-menu-item:hover { background-color: rgba(124, 58, 237, 0.05); color: var(--primary-color); }
        .settings-menu-item i { font-size: 1.3rem; width: 35px; margin-right: 15px; color: var(--primary-color); }
        .settings-menu-item.logout i { color: #EF4444; }
        .settings-menu-item span { font-weight: 500; flex-grow: 1; }
        .settings-menu-item .settings-control { margin-left: auto; }
        
        /* Theme Switch Styles */
        .switch-container { position: relative; display: inline-block; width: 50px; height: 28px; }
        .switch-container input { opacity: 0; width: 0; height: 0; }
        .switch-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--border-color); transition: .4s; border-radius: 28px; }
        .switch-slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .switch-slider { background-color: var(--primary-color); }
        input:checked + .switch-slider:before { transform: translateX(22px); }
        
        .language-select { background-color: var(--input-bg); border: 1px solid var(--input-border); border-radius: var(--border-radius-sm); padding: 5px 10px; color: var(--text-primary); font-weight: 500; }

        .leaderboard-section { padding-bottom: 80px; }
        .leaderboard-header { background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)); padding: 10px 20px 70px; color: white; text-align: center; border-bottom-left-radius: var(--border-radius); border-bottom-right-radius: var(--border-radius); margin-bottom: -60px; position: relative; z-index: 1; }
        .leaderboard-header h2 { font-size: 1.5rem; font-weight: 700; margin-bottom: 5px; }
        .leaderboard-header p { font-size: 0.9rem; opacity: 0.8; }
        .top-three-container { display: flex; justify-content: space-around; align-items: flex-end; margin-top: 50px; gap: 10px; }
        .top-user { display: flex; flex-direction: column; align-items: center; color: white; width: 30%; position: relative; }
        .top-user.rank-1 { transform: translateY(-20px); }
        .top-user .rank-medal { position: absolute; top: -30px; font-size: 2rem; z-index: 10; color: var(--accent-color); text-shadow: 0 0 5px rgba(0, 0, 0, 0.5); }
        .top-user.rank-1 .rank-medal { font-size: 2.5rem; color: #FFD700; }
        .top-user .pfp-container { width: 70px; height: 70px; border-radius: 50%; border: 3px solid white; overflow: hidden; margin-bottom: 8px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3); }
        .top-user.rank-1 .pfp-container { width: 90px; height: 90px; border-color: #FFD700; }
        .top-user img { width: 100%; height: 100%; object-fit: cover; }
        .top-user .name { font-size: 0.9rem; font-weight: 600; text-overflow: ellipsis; overflow: hidden; white-space: nowrap; width: 100%; text-align: center; }
        .top-user .points { font-size: 0.8rem; opacity: 0.9; font-weight: 500; }
        .leaderboard-list { background: var(--card-bg); border-radius: var(--border-radius); padding: 10px 0; margin: 0 20px; box-shadow: 0 5px 30px rgba(0, 0, 0, 0.1); list-style: none; position: relative; z-index: 5; border: 1px solid var(--border-color); }
        .leaderboard-item { display: flex; align-items: center; padding: 12px 20px; border-bottom: 1px solid var(--border-color); color: var(--text-primary); }
        .leaderboard-item:last-child { border-bottom: none; }
        .rank { font-size: 1.1rem; font-weight: 700; width: 30px; text-align: left; color: var(--text-secondary); }
        .user-info { display: flex; align-items: center; flex-grow: 1; margin-left: 15px; }
        .user-pfp { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; margin-right: 15px; border: 2px solid var(--border-color); }
        .user-name { font-size: 1rem; font-weight: 500; }
        .user-points { font-size: 0.9rem; font-weight: 600; color: var(--primary-color); display: flex; align-items: center; }
        .user-points i { margin-left: 5px; color: var(--accent-color); }
        
        /* --- NEW WITHDRAW PAGE STYLES --- */
        .withdraw-page-container {
            display: flex;
            flex-direction: column;
            flex-grow: 1; /* Occupy all available vertical space */
            background-color: var(--app-bg);
            padding-bottom: 55px; /* Space for the bottom nav */
        }
        .withdraw-header {
            background: var(--header-bg);
            color: white;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            border-bottom-left-radius: 24px;
            border-bottom-right-radius: 24px;
            flex-shrink: 0;
            min-height: 120px;
        }
        .withdraw-header .back-btn {
            color: white;
            font-size: 1.2rem;
            text-decoration: none;
            padding: 5px;
        }
        .withdraw-header h2 {
            flex-grow: 1;
            text-align: center;
            font-size: 1.4rem;
            margin: 0;
            padding-right: 30px; /* Balance the back button space */
        }
        .balance-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            margin: -50px 20px 20px 20px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 2;
            border: 1px solid var(--border-color);
        }
        .balance-card .balance-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }
        .balance-card .balance-points {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .balance-card .balance-bdt {
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-secondary);
            margin-top: 5px;
        }
        .withdraw-form-card {
            margin: 0 20px 20px 20px;
            padding: 25px;
        }
        .withdraw-form-card .section-title {
            margin-bottom: 20px;
            font-size: 1.1rem;
            justify-content: center;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="header" id="appHeader">
            <div class="logo-container">
                <img src="2.png" alt="App Logo">
            </div>
            <button class="theme-toggle" id="themeToggle">
                <i class="fas fa-sun"></i>
            </button>
        </div>

        <div class="profile-section" id="profileSection">
            <div class="profile-card">
                <div class="profile-banner" id="profileBanner">
                    <button class="edit-banner-btn" id="editBannerBtn">
                        <i class="fas fa-camera"></i>
                    </button>
                </div>
                <div class="profile-pic-container">
                    <img src="https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_960_720.png" alt="Profile" class="profile-pic" id="profilePic">
                    <button class="edit-pfp-btn" id="editPfpBtn">
                        <i class="fas fa-camera"></i>
                    </button>
                </div>
                <div class="profile-info-header-row">
                    <div class="points-display" id="userPointsDisplay">
                        <i class="fas fa-coins"></i> 0 Points 
                    </div>
                    <h1 class="profile-name" id="profileNameDisplay" data-translate-key="loading">Loading...</h1>
                </div>
                <div class="stats-display">
                    <div class="stat-item">
                        <div class="stat-value" id="adsWatchedToday">0</div>
                        <div class="stat-label" data-translate-key="today">Today</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="adsLeftToday">0</div>
                        <div class="stat-label" data-translate-key="left">Left</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="totalAdsWatched">0</div>
                        <div class="stat-label" data-translate-key="total">Total</div>
                    </div>
                </div> 
            </div>
        </div>

        <main class="content-section" id="mainContent">
            <!-- Page content will be rendered here by JavaScript -->
        </main>
        
        <footer class="app-footer" id="appFooter">
            <div class="developer-credit">
                Developed by <a href="https://t.me/freeinternet_bd25" target="_blank" class="developer-link">SOJIB ALOM</a>
            </div>
            <div class="footer-socials">
                <a href="https://t.me/freeinternet_bd25" target="_blank" aria-label="Telegram Channel"><i class="fab fa-telegram-plane"></i></a>
                <a href="https://youtube.com/@gaming_xa1?si=1_iAFpbbvqrENgTD" target="_blank" aria-label="YouTube Channel"><i class="fab fa-youtube"></i></a>
            </div>
            <div class="footer-links">
                <a href="#" data-translate-key="privacyPolicy">Privacy Policy</a> | <a href="#" data-translate-key="termsOfService">Terms of Service</a>
            </div>
            <p class="footer-copyright">&copy; 2024 Ads to Earning. All Rights Reserved.</p>
        </footer>
        
        <div class="bottom-nav">
            <a href="#" class="nav-item active" data-page="home"><i class="fas fa-home"></i><span data-translate-key="navHome">Home</span></a>
            <a href="#" class="nav-item" data-page="tasks"><i class="fas fa-tasks"></i><span data-translate-key="navTasks">Tasks</span></a>
            <a href="#" class="nav-item" data-page="bonus"><i class="fas fa-gift"></i><span data-translate-key="navBonus">Bonus</span></a>
            <a href="#" class="nav-item" data-page="leaderboard"><i class="fas fa-trophy"></i><span data-translate-key="navLeaderboard">Leaderboard</span></a>
            <a href="#" class="nav-item" data-page="settings"><i class="fas fa-user"></i><span data-translate-key="navProfile">Profile</span></a>
        </div>
        
        <div class="ad-modal-overlay" id="adModal">
            <div class="ad-modal">
                <h3 class="ad-modal-title" id="adModalTitle" data-translate-key="loadingAd">Loading Ad...</h3>
                <div class="spinner" id="adSpinner"></div>
                <p class="ad-status" id="adStatusMessage" data-translate-key="pleaseWaitAd">Please wait while we load the ad</p>
                <button class="btn btn-primary" id="adCloseBtn" style="display: none;" data-translate-key="closeAndClaim">Close & Claim Reward</button>
            </div>
        </div>
        <div class="toast" id="toast"></div>
    </div>
    
    <script>
        // --- LANGUAGE TRANSLATIONS ---
        const translations = {
            en: {
                navHome: "Home", navTasks: "Tasks", navBonus: "Bonus", navLeaderboard: "Leaderboard", navProfile: "Profile",
                loading: "Loading...", pointsSuffix: "Points", today: "Today", left: "Left", total: "Total",
                welcome: "Welcome", welcomeDesc: "Welcome to {APP_NAME}, {userName}! Start earning points by completing tasks, watching ads, and inviting friends.",
                joinChannel: "Join Our Channel", dailyTask: "Daily Task", level2: "Level 2", progress: "Progress", watchAd: "Watch Ad", locked: "Locked",
                bonusRewards: "Bonus Rewards", bonusDesc: "Join our community channels to earn bonus points.", join: "Join", claimed: "Claimed",
                leaderboard: "Leaderboard", leaderboardDesc: "User with the highest points of the week", loadingLeaderboard: "Loading leaderboard...",
                profileTitle: "Profile", wallet: "Wallet", language: "Language", darkMode: "Dark Mode", privacyPolicy: "Privacy Policy",
                helpline: "Helpline / Support", logout: "Logout", verified: "Verified",
                backToProfile: "Back to Profile", withdraw: "Withdraw",
                yourCurrentBalance: "Your Current Balance",
                minWithdraw: "Minimum withdraw: {amount} BDT", coinRate: "Coin rate: {coins} = 1 BDT",
                paymentMethod: "Payment Method", selectMethod: "Select method", accountNumber: "Account Number (Phone)",
                accountPlaceholder: "e.g: 01xxxxxxxxx", amountBdt: "Amount (BDT)", minAmount: "Minimum {amount} BDT",
                submitRequest: "Submit Request", coinsNeeded: "Coins needed for withdraw: {coins}",
                errorMethod: "Please select a payment method.", errorAccount: "Please provide an account number.",
                errorInvalidAccount: "Invalid phone number (must be 11 digits).", errorAmount: "Amount must be a positive number.",
                errorMinAmount: "Minimum withdrawal amount is {amount} BDT.", errorInsufficientCoins: "Insufficient coins. Required: {coins} coins.",
                withdrawSuccess: "✅ Success! {amount} BDT ({coins} coins) withdrawal request submitted. It will be sent to {method} account {accountNumber}.",
                withdrawRequestSuccess: "Withdrawal request successful!", logoutConfirm: "Are you sure you want to log out? This will clear all your local data.",
                termsOfService: "Terms of Service", loadingAd: "Loading Ad...", pleaseWaitAd: "Please wait while we load the ad",
                closeAndClaim: "Close & Claim Reward", taskLimitReached: "Daily task limit reached. Try again after 24 hours.",
                taskLimitReachedL2: "Daily Level 2 task limit reached. Try again after 24 hours.",
                pointsAdded: "✅ {points} points added.", pointsAddedTaskDone: "✅ {points} points added. Daily task finished!",
                bonusAlreadyClaimed: "You have already claimed this bonus.", bonusClaimed: "✅ {reward} bonus points added!",
                policyComingSoon: "Privacy Policy page coming soon.", withdrawalDetails: "Withdrawal Details"
            },
            bn: {
                navHome: "হোম", navTasks: "টাস্ক", navBonus: "বোনাস", navLeaderboard: "লিডারবোর্ড", navProfile: "প্রোফাইল",
                loading: "লোড হচ্ছে...", pointsSuffix: "পয়েন্ট", today: "আজ", left: "বাকি", total: "মোট",
                welcome: "স্বাগতম", welcomeDesc: "{APP_NAME} এ আপনাকে স্বাগতম, {userName}! টাস্ক সম্পূর্ণ করে, বিজ্ঞাপন দেখে এবং বন্ধুদের আমন্ত্রণ জানিয়ে পয়েন্ট উপার্জন শুরু করুন।",
                joinChannel: "আমাদের চ্যানেলে যোগ দিন", dailyTask: "দৈনিক টাস্ক", level2: "লেভেল ২", progress: " অগ্রগতি", watchAd: "বিজ্ঞাপন দেখুন", locked: "লকড",
                bonusRewards: "বোনাস পুরস্কার", bonusDesc: "বোনাস পয়েন্ট পেতে আমাদের কমিউনিটি চ্যানেলগুলিতে যোগ দিন।", join: "যোগ দিন", claimed: "নেওয়া হয়েছে",
                leaderboard: "লিডারবোর্ড", leaderboardDesc: "সপ্তাহের সর্বোচ্চ পয়েন্ট অর্জনকারী ব্যবহারকারী", loadingLeaderboard: "লিডারবোর্ড লোড হচ্ছে...",
                profileTitle: "প্রোফাইল", wallet: "ওয়ালেট", language: "ভাষা", darkMode: "ডার্ক মোড", privacyPolicy: "গোপনীয়তা নীতি",
                helpline: "হেল্পলাইন / সাপোর্ট", logout: "লগআউট", verified: "ভেরিফাইড",
                backToProfile: "প্রোফাইলে ফিরে যান", withdraw: "উত্তোলন",
                yourCurrentBalance: "আপনার বর্তমান ব্যালেন্স",
                minWithdraw: "সর্বনিম্ন উত্তোলন: {amount} টাকা", coinRate: "কয়েনের রেট: {coins} = ১ টাকা",
                paymentMethod: "পেমেন্ট পদ্ধতি", selectMethod: "পদ্ধতি নির্বাচন করুন", accountNumber: "একাউন্ট নাম্বার (ফোন)",
                accountPlaceholder: "যেমন: ০১৯xxxxxxxx", amountBdt: "টাকার পরিমাণ", minAmount: "সর্বনিম্ন {amount} টাকা",
                submitRequest: "রিকোয়েস্ট জমা দিন", coinsNeeded: "উত্তোলনের জন্য প্রয়োজন: {coins} কয়েন।",
                errorMethod: "অনুগ্রহ করে একটি পেমেন্ট পদ্ধতি নির্বাচন করুন।", errorAccount: "অনুগ্রহ করে একাউন্ট নাম্বার দিন।",
                errorInvalidAccount: "ফোন নাম্বারটি সঠিক নয় (১১ সংখ্যার হতে হবে)।", errorAmount: "টাকার পরিমাণ অবশ্যই একটি ধনাত্মক সংখ্যা হতে হবে।",
                errorMinAmount: "সর্বনিম্ন উত্তোলনের পরিমাণ {amount} টাকা।", errorInsufficientCoins: "আপনার অ্যাকাউন্টে পর্যাপ্ত কয়েন নেই। প্রয়োজন: {coins} কয়েন।",
                withdrawSuccess: "✅ সফল! {amount} টাকা ({coins} কয়েন) উত্তোলনের অনুরোধ জমা দেওয়া হয়েছে। {method} অ্যাকাউন্টে {accountNumber} এ টাকা পাঠানো হবে।",
                withdrawRequestSuccess: "উত্তোলনের অনুরোধ সফল হয়েছে!", logoutConfirm: "আপনি কি নিশ্চিতভাবে লগআউট করতে চান? আপনার সমস্ত স্থানীয় ডেটা মুছে যাবে।",
                termsOfService: "শর্তাবলী", loadingAd: "বিজ্ঞাপন লোড হচ্ছে...", pleaseWaitAd: "অনুগ্রহ করে অপেক্ষা করুন",
                closeAndClaim: "বন্ধ করুন এবং পুরস্কার নিন", taskLimitReached: "দৈনিক টাস্ক শেষ। ২৪ ঘণ্টা পর আবার চেষ্টা করুন।",
                taskLimitReachedL2: "দৈনিক লেভেল ২ টাস্ক শেষ। ২৪ ঘণ্টা পর আবার চেষ্টা করুন।",
                pointsAdded: "✅ {points} পয়েন্ট যুক্ত হয়েছে।", pointsAddedTaskDone: "✅ {points} পয়েন্ট যুক্ত হয়েছে। দৈনিক টাস্ক শেষ!",
                bonusAlreadyClaimed: "আপনি ইতিমধ্যেই এই বোনাসটি গ্রহণ করেছেন।", bonusClaimed: "✅ {reward} বোনাস পয়েন্ট যুক্ত হয়েছে!",
                policyComingSoon: "গোপনীয়তা নীতি পৃষ্ঠা শীঘ্রই আসছে।", withdrawalDetails: "উত্তোলনের বিবরণ"
            }
        };
        
        let currentLanguage = localStorage.getItem('galaxyEarnLanguage') || 'en';

        // --- END LANGUAGE TRANSLATIONS ---

        // Configuration
        const APP_NAME = "Ads to Earning25 ";
        const DAILY_AD_LIMIT_LEVEL_1 = 20; 
        const POINTS_PER_AD = 5;
        const LEVEL_2_TASK_LIMIT = 25; 
        const POINTS_PER_AD_L2 = 10;
        const ADS_PER_DAY_LIMIT_DASHBOARD = 5000;
        const MIN_WITHDRAW_POINTS = 1000; 
        const BDT_PER_COIN = 0.1;
        const COINS_PER_BDT = 10;
        const DEVELOPER_TELEGRAM_PROFILE_LINK = "https://t.me/freeinternet_bd25";
        const OFFICIAL_CHANNEL_LINK = "https://t.me/freeinternet_bd25";
        const SUPPORT_GROUP_LINK = "https://t.me/safreenetbd";
        const DEFAULT_PFP_URL = 'https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_960_720.png';
        const DEFAULT_BANNER_URL = 'https://picsum.photos/400/90?blur=1';
        const BONUS_CHANNELS = [
            { id: 'tg_official_channel', name: 'Official Channel', link: OFFICIAL_CHANNEL_LINK, reward: 5, icon: 'fab fa-telegram-plane' },
            { id: 'tg_support_group', name: 'Support Group', link: SUPPORT_GROUP_LINK, reward: 5, icon: 'fas fa-headset' },
            { id: 'tg_community', name: 'Telegram Community', link: "https://t.me/freeinternet_bd25", reward: 5, icon: 'fab fa-telegram' },
            { id: 'wa_community', name: 'Youtube Community', link: "https://youtube.com/@gaming_xa1?si=1_iAFpbbvqrENgTD", reward: 10, icon: 'fab fa-youtube' }
        ];
        const ONE_DAY_MS = 24 * 60 * 60 * 1000;
        
        let timerInterval;
        let timerIntervalLevel2;

        // DOM Elements
        const themeToggleBtn = document.getElementById('themeToggle');
        const profileNameDisplay = document.getElementById('profileNameDisplay');
        const profilePic = document.getElementById('profilePic');
        const userPointsDisplay = document.getElementById('userPointsDisplay');
        const adsWatchedTodayEl = document.getElementById('adsWatchedToday');
        const adsLeftTodayEl = document.getElementById('adsLeftToday');
        const totalAdsWatchedEl = document.getElementById('totalAdsWatched');
        const mainContent = document.getElementById('mainContent');
        const bottomNavItems = document.querySelectorAll('.bottom-nav .nav-item');
        const adModal = document.getElementById('adModal');
        const adModalTitle = document.getElementById('adModalTitle');
        const adSpinner = document.getElementById('adSpinner');
        const adStatusMessage = document.getElementById('adStatusMessage');
        const adCloseBtn = document.getElementById('adCloseBtn');
        const toast = document.getElementById('toast');
        const profileBanner = document.getElementById('profileBanner');
        const appHeader = document.getElementById('appHeader');
        const profileSection = document.getElementById('profileSection');
        const appFooter = document.getElementById('appFooter');

        // Current user state
        let currentUser = { 
            name: 'Loading...', telegramId: null, photoUrl: DEFAULT_PFP_URL, bannerUrl: DEFAULT_BANNER_URL, 
            points: 0, adsWatchedToday: 0, adsWatchedTodayLevel2: 0, lastTaskResetTimestampLevel2: null, 
            totalAdsWatchedLifetime: 0, lastTaskResetTimestamp: null, lastAdWatchDate: null, 
            claimedBonuses: [], referralCode: '', referredBy: null, referredUsers: [] 
        };
        
        if (!window.Telegram || !Telegram.WebApp || !Telegram.WebApp.initDataUnsafe.user) {
             currentUser.name = 'Guest User'; currentUser.email = 'user@example.com';
             currentUser.verifiedStatus = 'Yes'; currentUser.telegramId = null; 
        }

        // Translation helper function
        function t(key, replacements = {}) {
            let text = (translations[currentLanguage] && translations[currentLanguage][key]) || translations['en'][key] || key;
            for (const placeholder in replacements) {
                text = text.replace(`{${placeholder}}`, replacements[placeholder]);
            }
            return text;
        }

        function applyTranslations() {
            document.querySelectorAll('[data-translate-key]').forEach(element => {
                const key = element.dataset.translateKey;
                element.textContent = t(key);
            });
        }

        function showToast(message, duration = 3000) {
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), duration);
        }

        function loadUserState() { /* ... same as before ... */ }
        function saveUserState() { /* ... same as before ... */ }
        // The loadUserState and saveUserState functions remain unchanged.
        // For brevity, I'm omitting them here, but they are in the full code block.
        function loadUserState() {
            let deviceId = localStorage.getItem('galaxyEarnDeviceId') || 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => { const r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8); return v.toString(16); });
            localStorage.setItem('galaxyEarnDeviceId', deviceId);
            let allUsersData = JSON.parse(localStorage.getItem('galaxyEarnAllUsers')) || {};
            if (window.Telegram && Telegram.WebApp && Telegram.WebApp.initDataUnsafe.user) {
                const tgUser = Telegram.WebApp.initDataUnsafe.user;
                const existingUser = Object.values(allUsersData).find(user => user.telegramId === tgUser.id);
                if (existingUser) {
                    currentUser = existingUser;
                    currentUser.name = `${tgUser.first_name || ''} ${tgUser.last_name || ''}`.trim() || currentUser.name;
                    currentUser.photoUrl = tgUser.photo_url || currentUser.photoUrl || DEFAULT_PFP_URL;
                } else {
                    currentUser = { 
                        name: `${tgUser.first_name || ''} ${tgUser.last_name || ''}`.trim() || `User${tgUser.id}`, 
                        telegramId: tgUser.id, photoUrl: tgUser.photo_url || DEFAULT_PFP_URL, bannerUrl: DEFAULT_BANNER_URL, 
                        points: 0, adsWatchedToday: 0, totalAdsWatchedLifetime: 0, lastTaskResetTimestamp: null,
                        adsWatchedTodayLevel2: 0, lastTaskResetTimestampLevel2: null, lastAdWatchDate: null, 
                        claimedBonuses: [], referralCode: Math.random().toString(36).substring(2, 10).toUpperCase(), 
                        referredBy: null, referredUsers: [],
                        email: `${tgUser.username || tgUser.id}@telegram.com`, verifiedStatus: 'Yes'
                    };
                }
                allUsersData[deviceId] = currentUser;
            } else {
                 if (!allUsersData[deviceId]) {
                    allUsersData[deviceId] = { 
                        name: 'Guest User', telegramId: null, photoUrl: DEFAULT_PFP_URL, bannerUrl: DEFAULT_BANNER_URL, 
                        points: 0, adsWatchedToday: 0, totalAdsWatchedLifetime: 0, lastTaskResetTimestamp: null,
                        adsWatchedTodayLevel2: 0, lastTaskResetTimestampLevel2: null, lastAdWatchDate: null, 
                        claimedBonuses: [], referralCode: Math.random().toString(36).substring(2, 10).toUpperCase(), 
                        referredBy: null, referredUsers: [],
                        email: 'user@example.com', verifiedStatus: 'Yes'
                    };
                 }
                 currentUser = allUsersData[deviceId];
            }
            if (!currentUser.bannerUrl) currentUser.bannerUrl = DEFAULT_BANNER_URL;
            if (currentUser.lastTaskResetTimestamp === undefined) currentUser.lastTaskResetTimestamp = null;
            if (currentUser.email === undefined) currentUser.email = 'user@example.com';
            if (currentUser.verifiedStatus === undefined) currentUser.verifiedStatus = 'Yes';
            if (currentUser.adsWatchedTodayLevel2 === undefined) currentUser.adsWatchedTodayLevel2 = 0;
            if (currentUser.lastTaskResetTimestampLevel2 === undefined) currentUser.lastTaskResetTimestampLevel2 = null;
            const now = Date.now();
            if (currentUser.lastTaskResetTimestamp && now >= currentUser.lastTaskResetTimestamp) {
                currentUser.adsWatchedToday = 0;
                currentUser.lastTaskResetTimestamp = null;
            }
            if (currentUser.lastTaskResetTimestampLevel2 && now >= currentUser.lastTaskResetTimestampLevel2) {
                currentUser.adsWatchedTodayLevel2 = 0;
                currentUser.lastTaskResetTimestampLevel2 = null; 
            }
            saveUserState();
            updateUI();
        }
        function saveUserState() {
            const deviceId = localStorage.getItem('galaxyEarnDeviceId');
            let allUsersData = JSON.parse(localStorage.getItem('galaxyEarnAllUsers')) || {};
            allUsersData[deviceId] = currentUser;
            localStorage.setItem('galaxyEarnAllUsers', JSON.stringify(allUsersData));
        }


        document.addEventListener('DOMContentLoaded', () => {
            if (window.Telegram && Telegram.WebApp) Telegram.WebApp.expand();
            applyTranslations();
            loadUserState();
            applyTheme(localStorage.getItem('galaxyEarnTheme') || 'light');
            navigateTo('home');
            themeToggleBtn.addEventListener('click', toggleTheme);
            bottomNavItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    navigateTo(item.dataset.page);
                });
            });
            adCloseBtn.addEventListener('click', closeAdModalAndReward);
            profileNameDisplay.addEventListener('click', promptForNewName); 
        });

        function applyTheme(theme) {
            document.body.classList.toggle('dark-mode', theme === 'dark');
            themeToggleBtn.innerHTML = theme === 'dark' ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
            localStorage.setItem('galaxyEarnTheme', theme);
        }

        function toggleTheme() {
            const newTheme = document.body.classList.contains('dark-mode') ? 'light' : 'dark';
            applyTheme(newTheme);
            const settingsThemeSwitch = document.getElementById('settingsThemeSwitch');
            if (settingsThemeSwitch) {
                settingsThemeSwitch.checked = (newTheme === 'dark');
            }
        }

        function updateUI() {
            if (profileNameDisplay) profileNameDisplay.textContent = currentUser.name;
            if (userPointsDisplay) userPointsDisplay.innerHTML = `<i class="fas fa-coins"></i> ${currentUser.points} ${t('pointsSuffix')}`;
            if (adsWatchedTodayEl) adsWatchedTodayEl.textContent = currentUser.adsWatchedToday + currentUser.adsWatchedTodayLevel2; 
            if (adsLeftTodayEl) adsLeftTodayEl.textContent = ADS_PER_DAY_LIMIT_DASHBOARD - (currentUser.adsWatchedToday + currentUser.adsWatchedTodayLevel2);
            if (totalAdsWatchedEl) totalAdsWatchedEl.textContent = currentUser.totalAdsWatchedLifetime;
            if (profilePic) profilePic.src = currentUser.photoUrl || DEFAULT_PFP_URL;
            if (profileBanner) profileBanner.style.backgroundImage = `url('${currentUser.bannerUrl}')`;
            
            const editBannerBtn = document.getElementById('editBannerBtn');
            const editPfpBtn = document.getElementById('editPfpBtn');
            if (editBannerBtn) editBannerBtn.addEventListener('click', promptForNewBanner);
            if (editPfpBtn) editPfpBtn.addEventListener('click', promptForNewProfilePic);
        }

        function promptForNewName() {
            const newName = prompt("Enter your new name:", currentUser.name);
            if (newName && newName.trim()) {
                currentUser.name = newName.trim();
                updateUI();
                saveUserState();
                showToast("Name updated successfully!");
                if (document.querySelector('.nav-item.active')?.dataset.page === 'settings') {
                    renderSettingsPage(); 
                }
            }
        }
        
        function promptForNewBanner() {
            const newBannerUrl = prompt("Enter banner image URL:", currentUser.bannerUrl === DEFAULT_BANNER_URL ? '' : currentUser.bannerUrl);
            if (newBannerUrl === null) return;
            currentUser.bannerUrl = (newBannerUrl && newBannerUrl.trim()) ? newBannerUrl.trim() : DEFAULT_BANNER_URL;
            updateUI();
            saveUserState();
            showToast("Banner updated.");
            if (document.querySelector('.nav-item.active')?.dataset.page === 'settings') {
                renderSettingsPage();
            }
        }
        
        function promptForNewProfilePic() {
            const newPfpUrl = prompt("Enter profile picture URL:", currentUser.photoUrl === DEFAULT_PFP_URL ? '' : currentUser.photoUrl);
            if (newPfpUrl === null) return;
            currentUser.photoUrl = (newPfpUrl && newPfpUrl.trim()) ? newPfpUrl.trim() : DEFAULT_PFP_URL;
            updateUI();
            saveUserState();
            showToast("Profile picture updated.");
            if (document.querySelector('.nav-item.active')?.dataset.page === 'settings') {
                renderSettingsPage();
            }
        }
        
        function startTaskTimer() { /* ... same as before ... */ }
        function startTaskTimerLevel2() { /* ... same as before ... */ }
        function startTaskTimer() {
            if (timerInterval) clearInterval(timerInterval);
            const watchDailyAdBtn = document.getElementById('watchDailyAdBtn');
            if (!watchDailyAdBtn) return;
            const targetTimestamp = currentUser.lastTaskResetTimestamp;
            if (!targetTimestamp) return;
            function updateTaskTimerDisplay() {
                const now = Date.now();
                const timeLeft = targetTimestamp - now;
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    currentUser.adsWatchedToday = 0;
                    currentUser.lastTaskResetTimestamp = null;
                    saveUserState();
                    renderTasksPage();
                    return;
                }
                const hours = Math.floor(timeLeft / 3600000);
                const minutes = Math.floor((timeLeft % 3600000) / 60000);
                const seconds = Math.floor((timeLeft % 60000) / 1000);
                watchDailyAdBtn.textContent = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                watchDailyAdBtn.disabled = true;
                watchDailyAdBtn.style.backgroundColor = 'var(--accent-color)';
            }
            updateTaskTimerDisplay();
            timerInterval = setInterval(updateTaskTimerDisplay, 1000);
        }
        function startTaskTimerLevel2() {
            if (timerIntervalLevel2) clearInterval(timerIntervalLevel2);
            const watchLevel2AdBtn = document.getElementById('watchLevel2AdBtn');
            if (!watchLevel2AdBtn) return;
            const targetTimestamp = currentUser.lastTaskResetTimestampLevel2;
            if (!targetTimestamp) return;
            function updateTaskTimerDisplay() {
                const now = Date.now();
                const timeLeft = targetTimestamp - now;
                if (timeLeft <= 0) {
                    clearInterval(timerIntervalLevel2);
                    currentUser.adsWatchedTodayLevel2 = 0;
                    currentUser.lastTaskResetTimestampLevel2 = null;
                    saveUserState();
                    renderTasksPage(); 
                    return;
                }
                const hours = Math.floor(timeLeft / 3600000);
                const minutes = Math.floor((timeLeft % 3600000) / 60000);
                const seconds = Math.floor((timeLeft % 60000) / 1000);
                watchLevel2AdBtn.textContent = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                watchLevel2AdBtn.disabled = true;
                watchLevel2AdBtn.style.backgroundColor = 'var(--accent-color)'; 
                watchLevel2AdBtn.style.color = 'white';
            }
            updateTaskTimerDisplay();
            timerIntervalLevel2 = setInterval(updateTaskTimerDisplay, 1000);
        }


        function navigateTo(page) {
            document.querySelector('.bottom-nav .nav-item.active')?.classList.remove('active');
            document.querySelector(`.nav-item[data-page="${page}"]`)?.classList.add('active');
            
            const isFullScreenPage = (page === 'settings' || page === 'leaderboard');
            if (appHeader) appHeader.style.display = isFullScreenPage ? 'none' : 'flex';
            if (profileSection) profileSection.style.display = isFullScreenPage ? 'none' : 'block';
            mainContent.style.padding = isFullScreenPage ? '0' : '20px';

            if (appFooter) {
                appFooter.style.display = isFullScreenPage ? 'none' : 'block';
            }
            
            if (timerInterval && page !== 'tasks') clearInterval(timerInterval);
            if (timerIntervalLevel2 && page !== 'tasks') clearInterval(timerIntervalLevel2);
            
            const pageRenderers = { home: renderHomePage, tasks: renderTasksPage, bonus: renderBonusPage, leaderboard: renderLeaderboardPage, settings: renderSettingsPage };
            if (pageRenderers[page]) {
                pageRenderers[page]();
            } else {
                renderHomePage();
            }
        }
        
        function renderHomePage() { /* ... same as before, but with t() ... */ }
        function renderTasksPage() { /* ... same as before, but with t() ... */ }
        function handleWatchDailyAd() { /* ... same as before, but with t() ... */ }
        function handleWatchLevel2Ad() { /* ... same as before, but with t() ... */ }
        function showModal(title, status = t('pleaseWaitAd'), buttonDisplay = 'none') {
            adModalTitle.textContent = title;
            adStatusMessage.textContent = status;
            adSpinner.style.display = 'block';
            adCloseBtn.style.display = buttonDisplay;
            adModal.classList.add('show');
        }
        function closeAdModal() { adModal.classList.remove('show'); }
        function closeAdModalAndReward() { closeAdModal(); }
        function handleBonusLinkClick(event, buttonElement) { /* ... same as before, but with t() ... */ }
        function renderBonusPage() { /* ... same as before, but with t() ... */ }
        function getMockLeaderboard() { /* ... same as before ... */ }
        function renderLeaderboardPage() { /* ... same as before, but with t() ... */ }
        // All these functions are updated in the full code block. For brevity, only showing the new/changed ones here.
        function renderHomePage() {
            mainContent.innerHTML = `<div class="task-card"><h2 class="section-title"><i class="fas fa-home"></i> ${t('welcome')}</h2><p class="task-description">${t('welcomeDesc', { APP_NAME: APP_NAME, userName: currentUser.name.split(' ')[0] })}</p><a href="${OFFICIAL_CHANNEL_LINK}" target="_blank" class="btn btn-primary" style="margin-top: 15px;">${t('joinChannel')}</a></div>`;
        }
        function renderTasksPage() {
            const completedAds = currentUser.adsWatchedToday; const taskLimit = DAILY_AD_LIMIT_LEVEL_1; const progressPercent = (completedAds / taskLimit) * 100; const isTaskComplete = completedAds >= taskLimit;
            let buttonText = isTaskComplete ? t('locked') : t('watchAd'); if (isTaskComplete && !currentUser.lastTaskResetTimestamp) { currentUser.lastTaskResetTimestamp = Date.now() + ONE_DAY_MS; saveUserState(); }
            const completedAdsL2 = currentUser.adsWatchedTodayLevel2; const taskLimitL2 = LEVEL_2_TASK_LIMIT; const progressPercentL2 = (completedAdsL2 / taskLimitL2) * 100; const isTaskCompleteL2 = completedAdsL2 >= taskLimitL2;
            let buttonTextL2 = isTaskCompleteL2 ? t('locked') : t('watchAd'); if (isTaskCompleteL2 && !currentUser.lastTaskResetTimestampLevel2) { currentUser.lastTaskResetTimestampLevel2 = Date.now() + ONE_DAY_MS; saveUserState(); }
            mainContent.innerHTML = `<div class="task-card-row"><div class="task-card-half"><div class="task-header" style="margin-bottom: 10px;"><div class="task-icon" style="width: 30px; height: 30px; font-size: 1.2rem; margin-right: 5px;"><i class="fas fa-ad"></i></div><div class="task-title" style="font-size: 1rem; font-weight: 700;">${t('dailyTask')}</div></div><div class="reward-badge" style="margin-bottom: 10px;">+${POINTS_PER_AD} ${t('pointsSuffix')}</div><div class="progress-container"><div class="progress-text" style="font-size: 0.7rem;"><span>${t('progress')}: ${completedAds}/${taskLimit}</span></div><div class="progress-bar" style="height: 6px;"><div class="progress" style="width: ${progressPercent}%"></div></div></div><button class="btn btn-primary" id="watchDailyAdBtn" ${isTaskComplete ? 'disabled' : ''}>${buttonText}</button></div><div class="task-card-half"><div class="task-header" style="margin-bottom: 10px;"><div class="task-icon" style="width: 30px; height: 30px; font-size: 1.2rem; margin-right: 5px; color: var(--secondary-color);"><i class="fas fa-rocket"></i></div><div class="task-title" style="font-size: 1rem; font-weight: 700; position: relative; padding-right: 35px;">${t('dailyTask')} <span class="level-superscript">${t('level2')}</span></div></div><div class="reward-badge" style="margin-bottom: 10px; background: rgba(20, 184, 166, 0.15); color: var(--secondary-color);">+${POINTS_PER_AD_L2} ${t('pointsSuffix')}</div><div class="progress-container" style="margin-bottom: 5px;"><div class="progress-text" style="font-size: 0.7rem;"><span>${t('progress')}: ${completedAdsL2}/${taskLimitL2}</span></div><div class="progress-bar" style="height: 6px;"><div class="progress" style="width: ${progressPercentL2}%"></div></div></div><button class="btn btn-primary" id="watchLevel2AdBtn" ${isTaskCompleteL2 ? 'disabled' : ''} style="background: ${isTaskCompleteL2 ? 'var(--border-color)' : 'var(--secondary-color)'}; color: ${isTaskCompleteL2 ? 'var(--text-secondary)' : 'white'};">${buttonTextL2}</button></div></div>`;
            if (!isTaskComplete) { document.getElementById('watchDailyAdBtn').addEventListener('click', handleWatchDailyAd); } else if (currentUser.lastTaskResetTimestamp) { startTaskTimer(); }
            if (!isTaskCompleteL2) { document.getElementById('watchLevel2AdBtn').addEventListener('click', handleWatchLevel2Ad); } else if (currentUser.lastTaskResetTimestampLevel2) { startTaskTimerLevel2(); }
        }
        function handleWatchDailyAd() {
            if (currentUser.adsWatchedToday >= DAILY_AD_LIMIT_LEVEL_1) { showToast(t('taskLimitReached'), 5000); if (!currentUser.lastTaskResetTimestamp) { currentUser.lastTaskResetTimestamp = Date.now() + ONE_DAY_MS; saveUserState(); renderTasksPage(); } return; }
            showModal(t('loadingAd')); setTimeout(() => { currentUser.points += POINTS_PER_AD; currentUser.adsWatchedToday += 1; currentUser.totalAdsWatchedLifetime += 1; currentUser.lastAdWatchDate = new Date().toISOString(); if (currentUser.adsWatchedToday >= DAILY_AD_LIMIT_LEVEL_1) { currentUser.lastTaskResetTimestamp = Date.now() + ONE_DAY_MS; showToast(t('pointsAddedTaskDone', {points: POINTS_PER_AD}), 5000); } else { showToast(t('pointsAdded', {points: POINTS_PER_AD}), 3000); } saveUserState(); updateUI(); renderTasksPage(); closeAdModal(); }, 3000);
        }
        function handleWatchLevel2Ad() {
            if (currentUser.adsWatchedTodayLevel2 >= LEVEL_2_TASK_LIMIT) { showToast(t('taskLimitReachedL2'), 5000); if (!currentUser.lastTaskResetTimestampLevel2) { currentUser.lastTaskResetTimestampLevel2 = Date.now() + ONE_DAY_MS; saveUserState(); renderTasksPage(); } return; }
            showModal(t('loadingAd')); setTimeout(() => { currentUser.points += POINTS_PER_AD_L2; currentUser.adsWatchedTodayLevel2 += 1; currentUser.totalAdsWatchedLifetime += 1; if (currentUser.adsWatchedTodayLevel2 >= LEVEL_2_TASK_LIMIT) { currentUser.lastTaskResetTimestampLevel2 = Date.now() + ONE_DAY_MS; showToast(t('pointsAddedTaskDone', {points: POINTS_PER_AD_L2}), 5000); } else { showToast(t('pointsAdded', {points: POINTS_PER_AD_L2}), 3000); } saveUserState(); updateUI(); renderTasksPage(); closeAdModal(); }, 3000); 
        }
        function handleBonusLinkClick(event, buttonElement) {
            const channelId = buttonElement.dataset.channelId, reward = parseInt(buttonElement.dataset.reward);
            if (currentUser.claimedBonuses.includes(channelId)) { event.preventDefault(); showToast(t('bonusAlreadyClaimed')); return; }
            buttonElement.textContent = t('claimed'); buttonElement.classList.add('claimed');
            setTimeout(() => { currentUser.points += reward; currentUser.claimedBonuses.push(channelId); saveUserState(); updateUI(); showToast(t('bonusClaimed', {reward: reward})); }, 500);
        }
        function renderBonusPage() {
            let channelsHtml = BONUS_CHANNELS.map(ch => `<li class="channel-item"><div class="channel-info"><div class="channel-icon"><i class="${ch.icon}"></i></div><div><div class="channel-name">${ch.name}</div><div class="channel-reward">+${ch.reward} ${t('pointsSuffix')}</div></div></div><a href="${ch.link}" target="_blank" class="join-btn ${currentUser.claimedBonuses.includes(ch.id) ? 'claimed' : ''}" data-channel-id="${ch.id}" data-reward="${ch.reward}" onclick="handleBonusLinkClick(event, this)">${currentUser.claimedBonuses.includes(ch.id) ? t('claimed') : t('join')}</a></li>`).join('');
            mainContent.innerHTML = `<div class="task-card"><h2 class="section-title"><i class="fas fa-gift"></i> ${t('bonusRewards')}</h2><p class="task-description">${t('bonusDesc')}</p><ul class="channel-list">${channelsHtml}</ul></div>`;
        }
        function getMockLeaderboard() {
            return [{ name: "#Sojib", points: 2500, photoUrl: "https://i.pravatar.cc/150?img=1" },{ name: "#Hridoy", points: 1850, photoUrl: "https://i.pravatar.cc/150?img=2" },{ name: "#Sumon", points: 1500, photoUrl: "https://i.pravatar.cc/150?img=3" },{ name: "#Shakil", points: 1200, photoUrl: "https://i.pravatar.cc/150?img=4" },{ name: "#Rifat", points: 950, photoUrl: "https://i.pravatar.cc/150?img=5" },{ name: "#Jahid", points: 700, photoUrl: "https://i.pravatar.cc/150?img=6" },{ name: "#Akash", points: 500, photoUrl: "https://i.pravatar.cc/150?img=7" },{ name: "#Nazmul", points: 300, photoUrl: "https://i.pravatar.cc/150?img=8" },{ name: "#soboj", points: 200, photoUrl: "https://i.pravatar.cc/150?img=9" },{ name: "#mamun", points: 100, photoUrl: "https://i.pravatar.cc/150?img=10" }].map((user, index) => ({ ...user, rank: index + 1 }));
        }
        function renderLeaderboardPage() {
            const allUsers = getMockLeaderboard(); const topThree = allUsers.slice(0, 3);
            const renderTopUser = (user, rank) => `<div class="top-user rank-${rank}"><i class="${rank === 1 ? 'fas fa-medal' : (rank === 2 ? 'fas fa-award' : 'fas fa-ribbon')} rank-medal"></i><div class="pfp-container"><img src="${user.photoUrl || DEFAULT_PFP_URL}" alt="Rank ${rank} PFP"></div><div class="name">${user.name.split(' ')[0]}</div><div class="points">${user.points} ${t('pointsSuffix')}</div></div>`;
            let listHtml = allUsers.map(user => `<li class="leaderboard-item"><span class="rank">${user.rank}</span><div class="user-info"><img src="${user.photoUrl || DEFAULT_PFP_URL}" alt="PFP" class="user-pfp"><span class="user-name">${user.name}</span></div><span class="user-points">${user.points} <i class="fas fa-coins"></i></span></li>`).join('');
            mainContent.innerHTML = `<div class="leaderboard-section"><div class="leaderboard-header"><h2><i class="fas fa-trophy"></i> ${t('leaderboard')}</h2><p>${t('leaderboardDesc')}</p><div class="top-three-container">${topThree.length >= 2 ? renderTopUser(topThree[1], 2) : ''}${topThree.length >= 1 ? renderTopUser(topThree[0], 1) : ''}${topThree.length >= 3 ? renderTopUser(topThree[2], 3) : ''}</div></div><ul class="leaderboard-list">${listHtml || `<div class="empty-state" style="padding: 20px 0;">${t('loadingLeaderboard')}</div>`}</ul></div>`;
        }

        function renderWalletWithdrawForm() {
            if (appFooter) appFooter.style.display = 'none';
            mainContent.style.padding = '0';
            const minWithdrawBdt = MIN_WITHDRAW_POINTS / COINS_PER_BDT;
            const userBdt = (currentUser.points * BDT_PER_COIN).toFixed(2);
            mainContent.innerHTML = `
                <div class="withdraw-page-container">
                    <div class="withdraw-header">
                        <a href="#" id="backToSettingsBtn" class="back-btn"><i class="fas fa-arrow-left"></i></a>
                        <h2>${t('withdraw')}</h2>
                    </div>
                    <div class="balance-card">
                        <div class="balance-label">${t('yourCurrentBalance')}</div>
                        <div class="balance-points"><i class="fas fa-coins"></i>${currentUser.points}</div>
                        <div class="balance-bdt">≈ ${userBdt} BDT</div>
                    </div>
                    <div class="task-card withdraw-form-card">
                        <h3 class="section-title"><i class="fas fa-money-check-alt"></i> ${t('withdrawalDetails')}</h3>
                        <p class="task-description" style="text-align: center; font-size: 0.8rem; margin-top: -15px; margin-bottom: 20px;">
                            ${t('minWithdraw', {amount: minWithdrawBdt})} | ${t('coinRate', {coins: COINS_PER_BDT})}
                        </p>
                        <div class="input-group">
                            <label class="input-label">${t('paymentMethod')}</label>
                            <select id="withdrawMethodSelect" class="select-field">
                                <option value="">${t('selectMethod')}</option>
                                <option value="bKash">বিকাশ</option> <option value="Nagad">নগদ</option> <option value="Rocket">রকেট</option> <option value="Upay">উপায়</option>
                            </select>
                            <p class="error-text" id="error-method" style="color: #EF4444; font-size: 0.8rem; margin-top: 5px; display: none;"></p>
                        </div>
                        <div class="input-group">
                            <label class="input-label">${t('accountNumber')}</label>
                            <input type="tel" id="withdrawAccountInput" class="input-field" placeholder="${t('accountPlaceholder')}" maxlength="11">
                            <p class="error-text" id="error-account" style="color: #EF4444; font-size: 0.8rem; margin-top: 5px; display: none;"></p>
                        </div>
                        <div class="input-group">
                            <label class="input-label">${t('amountBdt')}</label>
                            <input type="number" id="withdrawAmountInput" class="input-field" placeholder="${t('minAmount', {amount: minWithdrawBdt})}">
                            <p id="coinCalculation" style="margin-top: 10px;"></p>
                        </div>
                        <button class="btn btn-primary" id="submitWithdrawBtn"><i class="fas fa-paper-plane"></i> ${t('submitRequest')}</button>
                        <p class="status-message" id="withdrawStatusMsg"></p>
                    </div>
                </div>`;
            
            document.getElementById('backToSettingsBtn').addEventListener('click', (e) => { e.preventDefault(); navigateTo('settings'); });
            document.getElementById('withdrawAmountInput').addEventListener('input', () => {
                const bdtAmount = parseInt(document.getElementById('withdrawAmountInput').value) || 0;
                document.getElementById('coinCalculation').textContent = bdtAmount > 0 ? t('coinsNeeded', {coins: bdtAmount * COINS_PER_BDT}) : '';
            });
            document.getElementById('submitWithdrawBtn').addEventListener('click', handleSubmitWithdrawal);
        }

        function renderSettingsPage() {
            loadUserState();
            const isDarkMode = document.body.classList.contains('dark-mode');
            mainContent.innerHTML = `
                <div class="profile-header-settings">
                    <div class="profile-banner-settings" style="background-image: url('${currentUser.bannerUrl}')"><button class="edit-banner-btn" id="settingsEditBannerBtn"><i class="fas fa-camera"></i></button></div>
                    <div class="profile-summary-settings">
                        <div class="guest-user-pic" id="settingsPfpContainer"><img src="${currentUser.photoUrl || DEFAULT_PFP_URL}" alt="Profile Picture" id="settingsPfp"><button class="edit-pfp-btn" id="settingsEditPfpBtn"><i class="fas fa-camera"></i></button></div>
                        <div class="user-details-settings">
                            <h1 class="guest-user-name">${currentUser.name}</h1>
                            <p class="profile-email-settings"><i class="fas fa-envelope"></i><span>${currentUser.email || 'N/A'}</span></p>
                            <p class="profile-verified-settings"><i class="fas fa-check-circle"></i><span>${t('verified')}: ${currentUser.verifiedStatus}</span></p>
                        </div>
                    </div>
                </div>
                <div class="task-card" style="margin: 0 20px 20px 20px; padding: 10px 20px; border: 1px solid var(--border-color); "><h2 class="section-title" style="margin-bottom: 15px; font-size: 1.1rem;"><i class="fas fa-user-cog"></i> ${t('profileTitle')}</h2>
                    <div>
                        <a href="#" class="settings-menu-item" id="walletWithdrawBtn"><i class="fas fa-wallet"></i><span>${t('wallet')}</span></a>
                        <div class="settings-menu-item"><i class="fas fa-language"></i><span>${t('language')}</span><div class="settings-control"><select class="language-select" id="languageSelector"><option value="en" ${currentLanguage === 'en' ? 'selected' : ''}>English</option><option value="bn" ${currentLanguage === 'bn' ? 'selected' : ''}>বাংলা</option></select></div></div>
                        <div class="settings-menu-item"><i class="fas fa-moon"></i><span>${t('darkMode')}</span><div class="settings-control"><label class="switch-container"><input type="checkbox" id="settingsThemeSwitch" ${isDarkMode ? 'checked' : ''}><span class="switch-slider"></span></label></div></div>
                        <a href="#" class="settings-menu-item" id="privacyPolicyBtn"><i class="fas fa-shield-alt"></i><span>${t('privacyPolicy')}</span></a>
                        <a href="${SUPPORT_GROUP_LINK}" target="_blank" class="settings-menu-item" id="helplineBtn"><i class="fas fa-headset"></i><span>${t('helpline')}</span></a>
                        <a href="#" class="settings-menu-item logout" id="logoutBtn"><i class="fas fa-sign-out-alt"></i><span>${t('logout')}</span></a>
                    </div>
                </div>`;
            
            document.getElementById('settingsEditPfpBtn').addEventListener('click', promptForNewProfilePic);
            document.getElementById('settingsEditBannerBtn').addEventListener('click', promptForNewBanner);
            document.getElementById('walletWithdrawBtn').addEventListener('click', (e) => { e.preventDefault(); renderWalletWithdrawForm(); });
            document.getElementById('privacyPolicyBtn').addEventListener('click', (e) => { e.preventDefault(); showToast(t('policyComingSoon')); });
            document.getElementById('settingsThemeSwitch').addEventListener('change', toggleTheme);
            document.getElementById('languageSelector').addEventListener('change', (e) => {
                currentLanguage = e.target.value; localStorage.setItem('galaxyEarnLanguage', currentLanguage);
                applyTranslations(); navigateTo(document.querySelector('.nav-item.active').dataset.page); 
            });
            document.getElementById('logoutBtn').addEventListener('click', (e) => {
                e.preventDefault();
                if (confirm(t('logoutConfirm'))) { localStorage.clear(); window.location.reload(); }
            });
        }

        function setError(elementId, messageKey, replacements = {}) {
            const el = document.getElementById(elementId);
            const errorTextId = 'error-' + elementId.replace('withdraw', '').toLowerCase().replace('input', '').replace('select', '');
            const errorTextEl = document.getElementById(errorTextId);
            if (el) el.classList.add('error');
            if (errorTextEl && messageKey) { errorTextEl.textContent = t(messageKey, replacements); errorTextEl.style.display = 'block'; }
        }

        function clearError(elementId) {
            const el = document.getElementById(elementId);
            const errorTextId = 'error-' + elementId.replace('withdraw', '').toLowerCase().replace('input', '').replace('select', '');
            const errorTextEl = document.getElementById(errorTextId);
            if (el) el.classList.remove('error');
            if (errorTextEl) { errorTextEl.style.display = 'none'; errorTextEl.textContent = ''; }
        }

        function handleSubmitWithdrawal() {
            const withdrawMethodEl = document.getElementById('withdrawMethodSelect'), accountNumberEl = document.getElementById('withdrawAccountInput'), bdtAmountEl = document.getElementById('withdrawAmountInput'), statusMsgEl = document.getElementById('withdrawStatusMsg');
            const withdrawMethod = withdrawMethodEl.value, accountNumber = accountNumberEl.value.trim(), bdtAmount = parseInt(bdtAmountEl.value), minWithdrawBdt = MIN_WITHDRAW_POINTS / COINS_PER_BDT;
            statusMsgEl.textContent = ''; statusMsgEl.className = 'status-message'; 
            clearError('withdrawMethodSelect'); clearError('withdrawAccountInput'); clearError('withdrawAmountInput');
            let isValid = true;
            if (!withdrawMethod) { setError('withdrawMethodSelect', 'errorMethod'); isValid = false; }
            if (!accountNumber) { setError('withdrawAccountInput', 'errorAccount'); isValid = false; } 
            else if (accountNumber.length < 11 || !/^\d+$/.test(accountNumber)) { setError('withdrawAccountInput', 'errorInvalidAccount'); isValid = false; }
            if (isNaN(bdtAmount) || bdtAmount <= 0) { setError('withdrawAmountInput', 'errorAmount'); isValid = false; } 
            else if (bdtAmount < minWithdrawBdt) { setError('withdrawAmountInput', 'errorMinAmount', {amount: minWithdrawBdt}); isValid = false; } 
            if (isValid) {
                const requiredCoins = bdtAmount * COINS_PER_BDT;
                if (currentUser.points < requiredCoins) { setError('withdrawAmountInput', 'errorInsufficientCoins', {coins: requiredCoins}); isValid = false; }
            }
            if (!isValid) return;

            const requiredCoins = bdtAmount * COINS_PER_BDT;
            currentUser.points -= requiredCoins;
            saveUserState(); updateUI(); 

            const successMessage = t('withdrawSuccess', { amount: bdtAmount, coins: requiredCoins, method: withdrawMethod, accountNumber: accountNumber });
            statusMsgEl.classList.add('success-message'); statusMsgEl.textContent = successMessage;
            showToast(t('withdrawRequestSuccess'), 5000);
            
            // Send to Telegram logic here
            
            withdrawMethodEl.value = ''; accountNumberEl.value = ''; bdtAmountEl.value = ''; document.getElementById('coinCalculation').textContent = '';
        }

        function sendToTelegram(message) {
            console.log("Sending to Telegram:", message);
        }

    </script>
</body>
</html>